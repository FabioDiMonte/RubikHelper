/*! RubikUtils - v0.1.0 - 2015-04-24 */
var RubikUtils=function(){var a=function(){return{colors:{U:"#ffff00",D:"#ffffff",F:"#ff0000",B:"#ffaa00",L:"#0000ff",R:"#008800",light:"#ffff00",grey:"#cccccc",core:"#222222"},patterns:{p_O4E:" (M'U)4   (MU)4 ",p_O2U:" (M'U)3 U (MU)3 U ",p_O2D:" (M'D)3 D (MD)3 D ",p_O2F:" (M'F)3 F (MF)3 F ",p_O2B:" (M'B)3 B (MB)3 B ",p_O6L:" (R'FRU)5 ",p_O6R:" ([O6L])m ",p_CW2:" (U'RU) R' (U'RU) ",p_CC2:" ([CW2])i ",p_CW3:" ((UR)'UR)2 ",p_CC3:" ([CW3])i ",p_PTJ:" (L'U2) LU (L'U2) (RU') L (RU')i ",p_PAR:" (U'F2) [PTJ] (U'F2)i ",s_UB:" ",s_UF:" (U2 M')2 ",s_DB:" ([UF])i ",s_UR:" R'U RU' ",s_DR:" U R RU' ",s_FR:"  URU' ",s_BR:" ([FR])i ",s_UL:" ([UR])m ",s_DL:" ([DR])m ",s_FL:" ([FR])m ",s_BL:" ([BR])m ",s_BU:" [UB] ",s_FU:" [UF] ",s_BD:" [DB] ",s_RU:" x' ([BR])' ",s_RD:" x' ([FR])' ",s_RF:" x' ([DR])' ",s_RB:" x' ([UR])' ",s_LU:" x' (([BR])')m ",s_LD:" x' (([FR])')m ",s_LF:" x' (([DR])')m ",s_LB:" x' (([UR])')m ",s_UBR:" ",s_URF:" U' (R F' RM' U R2 U') (MR' F R U R2') ",s_DRB:" ([URF])i ",s_ULB:" (LU)' (LU)",s_UFL:" L U'L' U [ULB] ",s_DLF:" U' L2 U ",s_DBL:" [DLF] [ULB] ",s_BRU:" (U'L'U) L (U'L'U) ",s_RUB:" ([BRU])i ",s_RFU:" (F'R) (UR2U') R' (FR) (UR2U') R ",s_FUR:" R2 U' RM'x L2M2 (ULU') R' (UL'U') L'R'U ",s_RBD:" R'UR2U'R'F'RUR2U'R'F ",s_BDR:" RUR' DL2 x2 U'RU L2x2 U'D'R ",s_LBU:" (U'L'U) ",s_BUL:" y RUR2U'R' y' ",s_FLU:" R' (ULU') ",s_LUF:" L' (U'L'U) ",s_LFD:" L2 (U'L'U) ",s_FDL:" (U'L'U) L' (U'LU)",s_BLD:" (U'LU) ",s_LDB:" L (U'L'U) "},pieces:{M2:["M2"],R2:["R2"],opposites:{buffers:{edges:["DF","FD","UB","BU"],corners:["DFR","RDF","FRD","UBR","RUB","BRU"]},normals:{edges:["UF","FU","DB","BD"],corners:["URF","FUR","RFU","DRB","BDR","RBD"]}},buffers:{edge:"DF",corner:"DFR"},cube:{U:"U",D:"D",F:"F",B:"B",L:"L",R:"R",DF:"DF",DR:"DR",DB:"DB",DL:"DL",UF:"UF",UR:"UR",UB:"UB",UL:"UL",FR:"FR",BR:"BR",FL:"FL",BL:"BL",DFR:"DFR",DRB:"DRB",DBL:"DBL",DLF:"DLF",URF:"URF",UBR:"UBR",ULB:"ULB",UFL:"UFL"},pieces:["U","D","F","B","L","R","DF","DR","DB","DL","UF","UR","UB","UL","FR","BR","FL","BL","DFR","DRB","DBL","DLF","URF","UBR","ULB","UFL"],faces:{U:["ULB","UB","UBR","UL","U","UR","UFL","UF","URF"],D:["DLF","DF","DFR","DL","D","DR","DBL","DB","DRB"],F:["FLU","FU","FUR","FL","F","FR","FDL","FD","FRD"],B:["BRU","BU","BUL","BR","B","BL","BDR","BD","BLD"],L:["LBU","LU","LUF","LB","L","LF","LDB","LD","LFD"],R:["RFU","RU","RUB","RF","R","RB","RDF","RD","RBD"]},slices:{M:["F","U","B","D","UF","UB","DB","DF"],E:["F","R","B","L","FL","FR","BL","BR"],S:["U","R","D","L","UL","UR","DR","DL"]},axis:{x:["U","F","D","B"],y:["F","L","B","R"],z:["U","R","D","L"]},noUnsetup:["UF","DB","FU","BD","DRB","RBD","BDR","URF","RFU","FUR"]},is:{face:function(a){return/^[udfblr]$/i.test(a)},slice:function(a){return/^[mes]$/i.test(a)},axis:function(a){return/^[xyz]$/i.test(a)},move:function(b){return a.is.face(b)||a.is.slice(b)||a.is.axis(b)},modifier:function(a){return/^[2i'\-\+]$/.test(a)},rotation:function(a){return/^[udfblrmesxyz][2i'\-\+]?$/i.test(a)},median:function(a){return/^([ud][fb]|[fb][ud])$/i.test(a)},pattern:function(a){return/^(o2[udfb]|o4e|o6[lr]|c[cw][23]|ptj|par)$/i.test(a)},piece:function(a){return/^(?:([udfblr])(?!.*\1)){2,3}$/i.test(a)},edge:function(b){return 2==b.length&&a.is.piece(b)},corner:function(b){return 3==b.length&&a.is.piece(b)},buffer:function(b){return a.is.edge(b)&&a.service.targetOf(b)==a.pieces.buffers.edge||a.is.corner(b)&&a.service.targetOf(b)==a.pieces.buffers.corner}},canbe:{negative:function(a){return 1==a.length||"+"==a.charAt(1)||"-"==a.charAt(1)},mirror:function(b){return a.canbe.negative(b)||"2"==b.charAt(1)},accepted:function(a,b,c){var d=!c&&!b||""==c&&""==b;return c&&"string"==typeof c&&(d=1==c.length&&c==a.charAt(0)),c&&c instanceof Array&&(d=c.indexOf(a)>-1),b&&"string"==typeof b&&(d=!(1==b.length&&b==a.charAt(0))),b&&b instanceof Array&&(d=-1==b.indexOf(a)),d}},service:{targetOf:function(b){var c,d,e,f,g,h=b.toUpperCase();return null==a.pieces.cube[h]&&(c=h.indexOf("U"),d=h.indexOf("D"),e=h.indexOf("F"),f=h.indexOf("B"),g=c>-1?c:d>-1?d:e>-1?e:f>-1?f:null,g&&(h=h.substr(g)+h.substr(0,g))),h},moveCounter:function(a,b){var c=0;for(var d in a)a.hasOwnProperty(d)&&(c+=Number(a[d]==b));return c},cloneCube:function(b){var c,d={};for(c in a.pieces.cube)a.pieces.cube.hasOwnProperty(c)&&(d[c]=b&&b[c]?b[c]:a.pieces.cube[c]);return d},getPieceFromStickers:function(b,c){var d,e;for(d in c)if(c.hasOwnProperty(d)&&(c[d]==b||c[d]==a.service.rotate(b,-1)||c[d]==a.service.rotate(b,1)))return e=a.service.getRotation(c[d]),a.service.rotate(d,e);return!1},getStickersFromPiece:function(b,c,d){var e,f,g=a.service.targetOf(b),h=c[g],i=[];if(b==g||!d&&a.is.median(b))return h;for(e=0;e<h.length;e++)f=g.indexOf(b.charAt(e)),i.push(h.charAt(f));return i.join("")},getRotation:function(b,c){if(2==b.length)return b!=a.service.targetOf(b);var d=null,e=a.service.targetOf(b);return b==e?d=0:(a.service.rotate(b,1)==e&&(d=c?1:-1),a.service.rotate(b,-1)==e&&(d=c?-1:1)),d},rotate:function(a,b){var c=0===b||2!==a.length&&-1!==b?2:1;return 0===b||b===!1?a:a.substr(c)+a.substr(0,c)},replaceMove:function(a,b,c){var d,e=[];for(d=0;d<a.length;d++)e.push(a[d].charAt(0)==b?c+a[d].substr(1):a[d]);return e},notAcceptedWithPiece:function(b){var c,d=a.pieces.axis,e=a.pieces.faces,f=[];if(b.length>=1){-1==d.x.indexOf(b[0])?c=d.x:-1==d.y.indexOf(b[0])?c=d.y:-1==d.z.indexOf(b[0])&&(c=d.z);for(var g in e)e.hasOwnProperty(g)&&-1==c.indexOf(g)&&f.push(g)}if(b.length>=2){var h="U"==b[0]||"F"==b[0]||"L"==b[0]?1:"D"==b[0]||"B"==b[0]||"R"==b[0]?-1:0,i=c.indexOf(b[1]),j=i+2,k=i+h+2*h;j>=c.length&&(j-=c.length),k>=c.length&&(k-=c.length),0>k&&(k=c.length+k),f.push(b[1]),f.push(c[j]),f.push(c[k])}return 3==b.length&&f.push(b[2]),f}},math:{multiply:function(a,b){var c,d=[];for(c=0;b>c;c++)d=d.concat(a);return d},negative:function(b){var c,d,e=b;return a.canbe.negative(b)&&(c=b.charAt(0),d=1==b.length?"+":b.charAt(1),d=a.math.signInverse(d),e=c+d),e},inverse:function(b){var c=b;return a.canbe.negative(b)&&(c=a.math.negative(b)),c},mirror:function(b,c){c||(c="M");var d,e,f=b;return a.canbe.mirror(b)&&(d=b.charAt(0),d="M"==c?"L"==d?"R":"R"==d?"L":d:d,d="E"==c?"U"==d?"D":"D"==d?"U":d:d,d="S"==c?"F"==d?"B":"B"==d?"F":d:d,e=1==b.length?"+":b.charAt(1),f=a.math.negative(d+e)),f},negativePattern:function(b,c,d){var e,f=[];for(e=0;e<b.length;e++)f.push(a.canbe.accepted(b[e],c,d)?a.math.negative(b[e]):b[e]);return f},inversePattern:function(b,c,d){var e,f=[];for(e=0;e<b.length;e++)f.unshift(a.canbe.accepted(b[e],c,d)?a.math.inverse(b[e]):b[e]);return f},mirrorPattern:function(b,c){var d,e=[];for(d=0;d<b.length;d++)e.push(a.math.mirror(b[d],c));return e},signSum:function(a,b){var c;return"2"==a&&(c="+"==b?"-":"-"==b?"+":null),"-"==a&&(c="2"==b?"+":"-"==b?"2":null),"+"==a&&(c="2"==b?"-":"+"==b?"2":null),c},signInverse:function(a){return"+"==a?"-":"-"==a?"+":a}},expand:{piece:function(b,c){var d,e=null!=a.patterns["s_"+b],f=null!=a.patterns["p_"+b],g=b;return(e||f)&&(g="["+b+"]",e&&c&&-1==a.pieces.noUnsetup.indexOf(b)&&(d=2==b.length?"M2":3==b.length?"R2":"",g=g+d+"("+g+")i")),a.parse.moves(g)},pattern:function(b){var c,d,e,f,g=[],h=[];for(c=0;c<b.length;c++)d=b[c],e=d.charAt(0),f=1==d.length?"+":d.charAt(1),a.is.rotation(d)&&(g=[d]),a.is.pattern(d)&&(g=a.expand.piece(d)),a.is.piece(d)&&(g=a.expand.piece(d,!0)),h=h.concat(g);return h}},parse:{moves:function(b,c,d,e){function f(a){(o?o:s>=0?r[s]:p).push(a)}function g(a){s>-1?r[s]=r[s].concat(a):p=p.concat(a)}function h(){if("("==j&&(r[++s]=[]),")"==j&&(n=r[s],l==Number(l)?n=a.math.multiply(n,Number(l)):"-"==l||"'"==l?n=a.math.negativePattern(n):"m"==l.toLowerCase()?n=a.math.mirrorPattern(n):"i"==l.toLowerCase()&&(n=a.math.inversePattern(n)),s--,g(n),("m"==l.toLowerCase()||"i"==l.toLowerCase())&&(l="")&&(j="")),"["!=j||o||(o=[]),"]"==j&&o){if(o=o.join("").toUpperCase(),a.is.piece(o)||a.is.pattern(o)){var b=a.is.piece(o)?"s_":a.is.pattern(o)?"p_":"",d=a.patterns[b+o];d&&g(a.parse.moves(d))}o=!1}o&&"["!=j?f(j):j&&a.is.move(j)&&(m="2"==l?c?"+":l:"+"==l||"-"==l?l:"i"==l||"'"==l?"-":"+",k=(e&&!o?j:a.clear.adjustCase(j))+m,c&&"2"==l&&f(k),f(k),o||e||j!=j.toLowerCase()||(k=!1,"u"==j?k="E"+m:"d"==j?k="E"+a.math.signInverse(m):"f"==j?k="S"+m:"b"==j?k="S"+a.math.signInverse(m):"l"==j?k="M"+m:"r"==j&&(k="M"+a.math.signInverse(m)),k&&f(k))),j=l}for(var i,j,k,l,m,n,o,p=[],q=a.clear.all(b).split(""),r=[],s=-1,t=0;t<q.length;t++)l=q[t],d||(l=a.clear.adjustCase(l)),h();return h(),i=c?a.clear.uncollapseSequence(p):a.clear.collapseSequence(p)},pieces:function(b,c){for(var d,e,f=[],g=a.clear.pieces(b).split(","),h=0;h<g.length;h++)e=g[h],1==e.length&&(e+="+"),e=a.is.piece(e)||a.is.pattern(e)?e.toUpperCase():a.is.rotation(e)?a.clear.adjustCase(e.charAt(0))+e.charAt(1):null,e&&f.push(e);return f=a.expand.pattern(a.clear.patterns(f)),d=c?a.clear.uncollapseSequence(f):a.clear.collapseSequence(f)}},clear:{all:function(a){return a.replace(/[^udfblrmesxyz2-9i'\-\+\(\)\[\]_oecwptja]+/gi,"")},pieces:function(a){return a=a.replace(/[i']+/gi,"-"),a=a.replace(/[,;\.\n\r ]+/g,","),a=a.replace(/[^udfblrmesxyz2\-\+,_oecwptja346]+/gi,"")},sequence:function(a){return a=a.replace(/[i']+/gi,"-"),a=a.replace(/[^udfblrmesxyz2i'\-\+]+/gi,"")},patterns:function(b){var c,d,e=[];for(d=0;d<b.length;d++)c=b[d],(a.is.piece(c)||a.is.rotation(c)||a.is.pattern(c))&&e.push(c);return e},adjustCase:function(b){return a.is.face(b)||a.is.slice(b)?b.toUpperCase():a.is.axis(b)?b.toLowerCase():b},collapseSequence:function(b){var c,d,e,f,g,h,i=[];for(g=0;g<b.length;g++)c=b[g].charAt(0),d=b[g].charAt(1),h=!0,g>0&&c==e&&(i.pop(),d==f?"2"==d?h=!1:d="2":(d=a.math.signSum(f,d),d||(h=!1))),h&&i.push(c+d),e=0==i.length?"":i[i.length-1].charAt(0),f=0==i.length?"":i[i.length-1].charAt(1);return i},uncollapseSequence:function(a){var b,c,d,e=[];for(d=0;d<a.length;d++)b=a[d].charAt(0),c=a[d].charAt(1),"2"==c&&(c="+",e.push(b+c)),e.push(b+c);return e}}}}();return a}();